<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd" >

<mapper namespace="com.lmxdawn.market.dao.SymbolDao">

    <select id="listPageDubbo" parameterType="com.lmxdawn.dubboapi.req.market.SymbolQueryDubboReq" resultType="com.lmxdawn.dubboapi.res.market.SymbolDubboRes">
        SELECT id,trade_coin_id,coin_id,fee,fee_precision,trade_total_precision,trade_price_precision,trade_amount_precision,sort,status,create_time,modified_time
        FROM `symbol`
        <where>
            <choose>
                <when test="status == 0">
                    status IN (1,2)
                </when>
                <otherwise>
                    status = #{status}
                </otherwise>
            </choose>
        </where>
        ORDER BY sort
        ASC
    </select>

    <select id="listAll" resultType="com.lmxdawn.market.entity.Symbol">
        SELECT id,trade_coin_id,coin_id,fee,fee_precision,trade_total_precision,trade_price_precision,trade_amount_precision,status
        FROM `symbol`
        <where>
            status = 1
        </where>
        ORDER BY `sort` ASC
    </select>

    <select id="findByTidAndCid" resultType="com.lmxdawn.market.entity.Symbol">
        SELECT id,fee,fee_precision,trade_total_precision,trade_price_precision,trade_amount_precision
        FROM `symbol`
        <where>
            trade_coin_id = #{tradeCoinId}
            and coin_id = #{coinId}
        </where>
        limit 1
    </select>

    <insert id="insert" keyProperty="id" parameterType="com.lmxdawn.market.entity.Symbol">
        INSERT INTO `symbol`(trade_coin_id,coin_id,fee,fee_precision,trade_total_precision,trade_price_precision,trade_amount_precision,sort,status,create_time,modified_time)
        VALUES
        (#{tradeCoinId},
         #{coinId},
         #{fee},
         #{feePrecision},
         #{tradeTotalPrecision},
         #{tradePricePrecision},
         #{tradeAmountPrecision},
         #{sort},
         #{status},
         #{createTime},
         #{modifiedTime})
    </insert>

    <update id="update" parameterType="com.lmxdawn.market.entity.Symbol">
        UPDATE `symbol`
        <trim prefix="set" suffixOverrides=",">
            <if test="tradeCoinId != null">`trade_coin_id`=#{tradeCoinId},</if>
            <if test="coinId != null">`coin_id`=#{coinId},</if>
            <if test="fee != null">`fee`=#{fee},</if>
            <if test="feePrecision != null">`fee_precision`=#{feePrecision},</if>
            <if test="tradeTotalPrecision != null">`trade_total_precision`=#{tradeTotalPrecision},</if>
            <if test="tradePricePrecision != null">`trade_price_precision`=#{tradePricePrecision},</if>
            <if test="tradeAmountPrecision != null">`trade_amount_precision`=#{tradeAmountPrecision},</if>
            <if test="sort != null">`sort`=#{sort},</if>
            <if test="status != null">`status`=#{status},</if>
            <if test="modifiedTime != null">`modified_time`=#{modifiedTime},</if>
        </trim>
        WHERE `id` = #{id}
    </update>

</mapper>